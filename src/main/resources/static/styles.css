:root{
  --bg:#f7f7fb; --text:#0f1222; --muted:#606578;
  --card:#ffffff; --line:#e6e8ef; --primary:#3b6cff; --primary-weak:#e8efff;
  --btn:#111321; --btn-text:#fff; --radius:14px; --gap:14px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;color:var(--text);background:var(--bg)}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
header{padding:18px 0}
h1{margin:0 0 6px;font-size:26px}
.lead{margin:0;color:var(--muted)}
.tabs{display:flex;gap:8px;border-bottom:1px solid var(--line);margin-top:16px}
.tab{padding:10px 14px;border:1px solid var(--line);border-bottom:none;border-radius:10px 10px 0 0;background:var(--card);color:var(--muted);text-decoration:none}
.tab.active{background:var(--primary-weak);color:var(--primary);font-weight:700;border-color:var(--primary-weak) var(--primary-weak) #fff var(--primary-weak)}
main{margin-top:12px}
.card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:16px}

/* 변환 탭 */
.grid{display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
@media (max-width:900px){.grid{grid-template-columns:1fr}}
h2{margin:0 0 10px}
label{font-size:14px;color:var(--muted)}
textarea{width:100%;min-height:260px;padding:10px;border:1px solid var(--line);border-radius:10px;resize:vertical;background:#fff;font:14px/1.5 ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
textarea.locked{background:#f3f4f8;color:#555;cursor:not-allowed}

/* ✅ div.viewer로 변경 (마크다운 HTML 표시용) */
.viewer{white-space:normal;min-height:180px;border:1px solid var(--line);border-radius:10px;padding:14px;background:#fff;font:14px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;overflow:auto;max-height:520px}

/* 마크다운 가독성 조금 향상 */
.viewer h1,.viewer h2,.viewer h3{margin:14px 0 8px}
.viewer p{margin:8px 0}
.viewer ul,.viewer ol{margin:8px 0 8px 20px}
.viewer code{background:#f6f7fb;border:1px solid var(--line);border-radius:6px;padding:2px 6px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
.viewer pre{background:#0b1020;color:#e6eaff;border-radius:10px;padding:12px;overflow:auto}
.viewer a{color:#2b5cff;text-decoration:underline}

/* 파일/입력/버튼 등 */
input[type="file"]{padding:6px 0}
input[type="text"]{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px;background:#fff}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.row.right{justify-content:flex-end}
.hint{color:var(--muted);font-size:13px}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--line);background:#f6f7fb;color:#586070;font-size:12px}
.btn{appearance:none;border:1px solid #121527;background:var(--btn);color:var(--btn-text);padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
.btn.ghost{background:#fff;color:#111;border-color:var(--line)}
.btn:disabled{opacity:.5;cursor:not-allowed}
.toast{position:fixed;bottom:16px;right:16px;background:#111;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;transform:translateY(8px);transition:.25s}
.toast.show{opacity:1;transform:translateY(0)}

/* 검색 탭 2열 레이아웃 */
.search-grid{display:grid;grid-template-columns:0.95fr 1.05fr;gap:16px}
@media (max-width:1000px){.search-grid{grid-template-columns:1fr}}

/* 좌측: 카테고리 아코디언 + 문서 체크리스트 */
.cats-card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px}
.cat-sec{border:1px solid var(--line);border-radius:10px;padding:10px;margin-bottom:10px;background:#fff;transition:.2s}
.cat-head{display:flex;align-items:center;gap:8px;cursor:pointer}
.cat-toggle{
  width:26px;height:26px;display:flex;align-items:center;justify-content:center;
  border:1px solid var(--line);border-radius:8px;background:#fff;flex:0 0 auto;
}
.cat-toggle .chev{display:inline-block;transition:transform .2s}
.cat-sec[aria-expanded="true"]  .chev{transform:rotate(90deg)}
.cat-title{font-weight:700}
.cat-count{margin-left:auto;font-size:12px;color:var(--muted);border:1px solid var(--line);border-radius:999px;padding:2px 8px;background:#f9f9ff}
.doc-list{margin:8px 0 0 0;padding:0;list-style:none;max-height:220px;overflow:auto}
.cat-sec[aria-expanded="false"] .doc-list{display:none} /* 기본 닫힘 */
.doc-item{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid var(--line);border-radius:8px;background:#fff;margin-bottom:6px}
.doc-item input{width:18px;height:18px}
.doc-item .title{flex:1}
.selected-info{font-size:12px;color:var(--muted);margin-top:8px}

/* 우측: 챗봇 카드 */
.chatcard{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px;display:grid;grid-template-rows:auto 1fr auto;gap:8px;min-height:520px}
.history{border:1px solid var(--line);border-radius:10px;background:#fff;padding:10px;min-height:420px;max-height:640px;overflow:auto}
.bubble{display:inline-block;padding:8px 12px;border-radius:14px;margin:6px 0;max-width:80%}
.me{background:#121527;color:#fff;margin-left:auto}
.bot{background:#f1f3fa;color:#111}
.toolbar{display:flex;gap:8px}
.toolbar input{flex:1;height:40px;padding:6px 10px;border:1px solid var(--line);border-radius:10px;background:#fff}
.toolbar .btn{height:40px;padding:0 14px;line-height:40px;border-radius:10px}


/* 메타바(연관도 등 요약) */
.metabar{
  display:inline-block;
  font-size:12px;
  color:#61677a;
  background:#f5f7ff;
  border:1px solid var(--line);
  border-radius:8px;
  padding:6px 8px;
  margin-bottom:8px;
}

/* 마크다운 뷰어(변환 결과 영역) */
.viewer.md h1,.viewer.md h2,.viewer.md h3{margin:10px 0 6px}
.viewer.md p, .viewer.md ul, .viewer.md ol{margin:6px 0}
.viewer.md ul{padding-left:18px}
.viewer.md code{background:#f6f7fb;border:1px solid var(--line);border-radius:6px;padding:2px 4px}
.viewer.md pre{white-space:pre-wrap;border:1px solid var(--line);border-radius:10px;padding:10px;background:#fff}
/* ===============================
   📘 Markdown Enhanced Styling
   =============================== */
.viewer.md {
  color: #111;
  background: #fff;
  font-size: 15px;
  line-height: 1.75;
  word-break: break-word;
}

/* 제목 */
.viewer.md h1, .viewer.md h2, .viewer.md h3, .viewer.md h4 {
  font-weight: 700;
  color: #0f1222;
  line-height: 1.3;
  margin-top: 1.2em;
  margin-bottom: 0.6em;
}
.viewer.md h1 { font-size: 1.7em; border-bottom: 2px solid var(--line); padding-bottom: 6px; }
.viewer.md h2 { font-size: 1.4em; border-bottom: 1px solid var(--line); padding-bottom: 4px; }
.viewer.md h3 { font-size: 1.2em; }

/* 본문 / 문단 */
.viewer.md p {
  margin: 0.6em 0;
  color: var(--text);
}

/* 강조 */
.viewer.md strong {
  color: #000;
}

/* 코드 */
.viewer.md code {
  background: #f5f6fa;
  border: 1px solid #e1e2ea;
  border-radius: 6px;
  padding: 2px 6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  color: #d63384;
}
.viewer.md pre {
  background: #0b1020;
  color: #e6eaff;
  border-radius: 10px;
  padding: 14px;
  overflow-x: auto;
  margin: 1em 0;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
}
.viewer.md pre code {
  background: transparent;
  border: none;
  color: inherit;
}

/* 인용구 */
.viewer.md blockquote {
  margin: 1em 0;
  padding: 0.6em 1em;
  border-left: 4px solid var(--primary);
  background: var(--primary-weak);
  color: #333;
  border-radius: 6px;
}

/* 리스트 */
.viewer.md ul, .viewer.md ol {
  padding-left: 22px;
  margin: 0.6em 0;
}
.viewer.md li {
  margin: 0.3em 0;
}

/* 링크 */
.viewer.md a {
  color: var(--primary);
  text-decoration: none;
  font-weight: 600;
}
.viewer.md a:hover {
  text-decoration: underline;
}

/* 표(Table) */
.viewer.md table {
  border-collapse: collapse;
  margin: 1em 0;
  width: 100%;
  font-size: 14px;
}
.viewer.md th, .viewer.md td {
  border: 1px solid var(--line);
  padding: 8px 10px;
  text-align: left;
}
.viewer.md th {
  background: var(--primary-weak);
  color: #0f1222;
  font-weight: 600;
}

/* 수평선 */
.viewer.md hr {
  border: none;
  border-top: 1px solid var(--line);
  margin: 1.4em 0;
}

/* 이미지 */
.viewer.md img {
  max-width: 100%;
  border-radius: 10px;
  margin: 8px 0;
  display: block;
}

/* 인라인 수식 / 강조 텍스트 */
.viewer.md em {
  color: #555;
  font-style: italic;
}

/* ✨ Chat bubble 내부 Markdown도 동일 적용 */
.bubble.bot .viewer.md {
  background: transparent;
  padding: 0;
  border: none;
}
